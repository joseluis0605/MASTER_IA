<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>1a23c23f3f6f414ca6854aa2131e1cf3</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="e4c6f3f9df5596c6" class="cell markdown">
<p><font size="4"></p>
<h2 id="dataset-saratoga-houses">Dataset: Saratoga Houses</h2>
<p>El dataset <strong>SaratogaHouses</strong> contiene información sobre
viviendas en el condado de Saratoga, Nueva York. Cada fila representa
una casa y las columnas describen diversas características relacionadas
con la propiedad, como el tamaño de la vivienda
(<code>livingArea</code>), el número de dormitorios y baños, la
presencia de garaje o chimenea, el año de construcción, el tamaño del
terreno (<code>landValue</code>), entre otros. La variable objetivo
suele ser el <strong>precio de venta</strong> de la casa
(<code>price</code>), lo que lo convierte en un dataset ideal para
problemas de regresión en ciencia de datos e inteligencia artificial.
Aunque algunas variables son numéricas, otras se comportan como
categóricas, lo que permite explorar técnicas de tratamiento mixto y
evaluación de modelos predictivos.</p>
<p>El dataset consta de 15 variables, a las cuales les acompaña la
columna precio, que es la variable objetivo. A continuación, veremos que
significa cada una de las variables de la matriz de características del
dataset:</p>
<ul>
<li>price: precio de la vivienda.</li>
<li>lotSize: metros cuadrados de la vivienda.</li>
<li>age: antigüedad de la vivienda.</li>
<li>landValue: valor del terreno.</li>
<li>livingArea: metros cuadrados habitables.</li>
<li>pctCollege: porcentaje del vecindario con título universitario.</li>
<li>bedrooms: número de dormitorios.</li>
<li>firplaces: número de chimeneas.</li>
<li>bathrooms: número de cuartos de baño (el valor 0.5 hace referencia a
cuartos de baño sin ducha).</li>
<li>rooms: número de habitaciones.</li>
<li>heating: tipo de calefacción.</li>
<li>fuel: tipo de alimentación de la calefacción (gas, electricidad o
diesel).</li>
<li>sewer: tipo de desagüe.</li>
<li>waterfront: si la vivienda tiene vistas al lago.</li>
<li>newConstruction: si la vivienda es de nueva construcción.</li>
<li>centralAir: si la vivienda tiene aire acondicionado.</li>
</ul>
<p>link de descarga: <a
href="https://www.kaggle.com/datasets/carloscinelli/saratoga"
class="uri">https://www.kaggle.com/datasets/carloscinelli/saratoga</a></p>
</div>
<div id="initial_id" class="cell code" data-execution_count="633"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:08.961269Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:08.958315Z&quot;}"
data-collapsed="true">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># importamos librerias</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier, KNeighborsRegressor, NearestNeighbors</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, OneHotEncoder</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div id="7abcef4ac8bc2f9c" class="cell code" data-execution_count="634"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:08.980189Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:08.970907Z&quot;}">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lectura del dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> pd.read_csv(<span class="st">&quot;SaratogaHouses.csv&quot;</span>, delimiter<span class="op">=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>dataset.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="634">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>lotSize</th>
      <th>age</th>
      <th>landValue</th>
      <th>livingArea</th>
      <th>pctCollege</th>
      <th>bedrooms</th>
      <th>fireplaces</th>
      <th>bathrooms</th>
      <th>rooms</th>
      <th>heating</th>
      <th>fuel</th>
      <th>sewer</th>
      <th>waterfront</th>
      <th>newConstruction</th>
      <th>centralAir</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>132500</td>
      <td>0.09</td>
      <td>42</td>
      <td>50000</td>
      <td>906</td>
      <td>35</td>
      <td>2</td>
      <td>1</td>
      <td>1.0</td>
      <td>5</td>
      <td>electric</td>
      <td>electric</td>
      <td>septic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>181115</td>
      <td>0.92</td>
      <td>0</td>
      <td>22300</td>
      <td>1953</td>
      <td>51</td>
      <td>3</td>
      <td>0</td>
      <td>2.5</td>
      <td>6</td>
      <td>hot water/steam</td>
      <td>gas</td>
      <td>septic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>109000</td>
      <td>0.19</td>
      <td>133</td>
      <td>7300</td>
      <td>1944</td>
      <td>51</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>8</td>
      <td>hot water/steam</td>
      <td>gas</td>
      <td>public/commercial</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>155000</td>
      <td>0.41</td>
      <td>13</td>
      <td>18700</td>
      <td>1944</td>
      <td>51</td>
      <td>3</td>
      <td>1</td>
      <td>1.5</td>
      <td>5</td>
      <td>hot air</td>
      <td>gas</td>
      <td>septic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>86060</td>
      <td>0.11</td>
      <td>0</td>
      <td>15000</td>
      <td>840</td>
      <td>51</td>
      <td>2</td>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>hot air</td>
      <td>gas</td>
      <td>public/commercial</td>
      <td>No</td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>5</th>
      <td>120000</td>
      <td>0.68</td>
      <td>31</td>
      <td>14000</td>
      <td>1152</td>
      <td>22</td>
      <td>4</td>
      <td>1</td>
      <td>1.0</td>
      <td>8</td>
      <td>hot air</td>
      <td>gas</td>
      <td>septic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>6</th>
      <td>153000</td>
      <td>0.40</td>
      <td>33</td>
      <td>23300</td>
      <td>2752</td>
      <td>51</td>
      <td>4</td>
      <td>1</td>
      <td>1.5</td>
      <td>8</td>
      <td>hot water/steam</td>
      <td>oil</td>
      <td>septic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>7</th>
      <td>170000</td>
      <td>1.21</td>
      <td>23</td>
      <td>14600</td>
      <td>1662</td>
      <td>35</td>
      <td>4</td>
      <td>1</td>
      <td>1.5</td>
      <td>9</td>
      <td>hot air</td>
      <td>oil</td>
      <td>septic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>8</th>
      <td>90000</td>
      <td>0.83</td>
      <td>36</td>
      <td>22200</td>
      <td>1632</td>
      <td>51</td>
      <td>3</td>
      <td>0</td>
      <td>1.5</td>
      <td>8</td>
      <td>electric</td>
      <td>electric</td>
      <td>septic</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>9</th>
      <td>122900</td>
      <td>1.94</td>
      <td>4</td>
      <td>21200</td>
      <td>1416</td>
      <td>44</td>
      <td>3</td>
      <td>0</td>
      <td>1.5</td>
      <td>6</td>
      <td>hot air</td>
      <td>gas</td>
      <td>none</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="d86502a3e752187a" class="cell markdown">
<p><font size="4"></p>
<h1 id="análisis-exploratorio-de-los-datos-eda">Análisis Exploratorio de
los Datos (EDA)</h1>
<p>Como podemos ver en el código debajo de este bloque de texto, el
dataset tiene una dimensión de 1728 registros por 16 columnas de
características. De estas 16 columnas, 15 pertenecen a la matriz de
características y la columna de precio es la columna a predecir, la que
vamos a tener como objetivo a predecir.</p>
<p>En cuanto a los tipos de variables, podemos apreciar que tenemos
tanto variables numéricas como variables de tipo caracter (object). De
las variables numéricas tenemos: precio, lotSize, age, landValue,
livinigArea, pctCollege, bedrooms, fireplaces, bathrooms y rooms. Por
otro lado, en cuanto a las variables categóricas tenemos: heating, fuel,
sewer, waterfront, newConstruction y centralAir.</p>
<p>Después, procedemos a ver la cantidad de valores nulos que tiene el
dataset ya que, en caso de que hubiesen, debiamos de tratarlos ya sea,
eliminandolos o escribiéndolos con valores promedios de su columna. En
este caso, no hay valores nulos en este dataset, por lo que procedemos a
saltarnos este paso.</p>
</div>
<div id="8b41d7d95eed0c89" class="cell code" data-execution_count="635"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.034506Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.032504Z&quot;}">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dimensiones del dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dataset.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="635">
<pre><code>(1728, 16)</code></pre>
</div>
</div>
<div id="2ca0039e57a823f2" class="cell code" data-execution_count="636"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.058549Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.054940Z&quot;}">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dataset.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1728 entries, 0 to 1727
Data columns (total 16 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   price            1728 non-null   int64  
 1   lotSize          1728 non-null   float64
 2   age              1728 non-null   int64  
 3   landValue        1728 non-null   int64  
 4   livingArea       1728 non-null   int64  
 5   pctCollege       1728 non-null   int64  
 6   bedrooms         1728 non-null   int64  
 7   fireplaces       1728 non-null   int64  
 8   bathrooms        1728 non-null   float64
 9   rooms            1728 non-null   int64  
 10  heating          1728 non-null   object 
 11  fuel             1728 non-null   object 
 12  sewer            1728 non-null   object 
 13  waterfront       1728 non-null   object 
 14  newConstruction  1728 non-null   object 
 15  centralAir       1728 non-null   object 
dtypes: float64(2), int64(8), object(6)
memory usage: 216.1+ KB
</code></pre>
</div>
</div>
<div id="543058a9153b3fb0" class="cell code" data-execution_count="637"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.097234Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.094353Z&quot;}">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Buscamos los valores nulos</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dataset.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="637">
<pre><code>price              0
lotSize            0
age                0
landValue          0
livingArea         0
pctCollege         0
bedrooms           0
fireplaces         0
bathrooms          0
rooms              0
heating            0
fuel               0
sewer              0
waterfront         0
newConstruction    0
centralAir         0
dtype: int64</code></pre>
</div>
</div>
<div id="3496878a0404fb3f" class="cell markdown">
<p><font size="4"></p>
<p>Ahora, vamos a proceder a analizar la variable precio, es decir, la
variable objetivo a predecir en este problema. Para ello, vamos a
realizar una gráfica para observar la distribución que siguen los
datos.</p>
<p>Como podemos observar, la columna objetivo, la columna "price", sigue
una distribución normal. Esto es importante tenerlo en cuenta ya que hay
modelos que no funcionan bien con una determinada distribución de los
datos.</p>
</div>
<div id="55368b489d5b45f3" class="cell code" data-execution_count="638"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.210713Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.145850Z&quot;}">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(dataset[<span class="st">&#39;price&#39;</span>], kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribución de precios de las viviendas&#39;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Precio&#39;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frecuencia&#39;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/291712ca5d20fb6e5d875912f8bc23d559f70a4e.png" /></p>
</div>
</div>
<div id="112258e91d99de38" class="cell markdown">
<p><font size="4"></p>
<h4 id="análisis-de-las-variables-numéricas">Análisis de las variables
numéricas</h4>
<p>En este apartado procederemos a analizar las variables númericas para
hacernos la idea de cómo es la distribución que siguen estos datos. Para
ello, utilizaremos gráficas de densidad debido a que al ser variables
numéricas, la posibilidad de valores es infinita.</p>
<p>Tras poder visualizar las gráficas de distribución de cada una de las
variables cuantitativas, se ha decidido que las siguientes columnas van
a tratarse como variables cualitativas y, por consiguiente, vamos a
realizar agrupaciones de los valores de estas, debido a que los
resultado están muy desequilibrados:</p>
<ul>
<li>bedrooms</li>
<li>fireplaces</li>
</ul>
<p>Es por ello, que vamos a convertirlas a tipo string (código debajo de
las gráficas)</p>
</div>
<div id="6aa332deaab6fc72" class="cell code" data-execution_count="639"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.741322Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.228504Z&quot;}">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>lista_columnas <span class="op">=</span> dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).columns</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>colores <span class="op">=</span> [<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;green&#39;</span>, <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;purple&#39;</span>, <span class="st">&#39;cyan&#39;</span>, <span class="st">&#39;magenta&#39;</span>, <span class="st">&#39;brown&#39;</span>, <span class="st">&#39;olive&#39;</span>, <span class="st">&#39;pink&#39;</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, columna <span class="kw">in</span> <span class="bu">enumerate</span>(lista_columnas):</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">3</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> colores[i <span class="op">%</span> <span class="bu">len</span>(colores)]  <span class="co"># Para evitar errores si hay más columnas que colore</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sns.histplot(dataset[columna], kde<span class="op">=</span><span class="va">True</span>, bins<span class="op">=</span><span class="dv">30</span>, color<span class="op">=</span> color)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Distribución de </span><span class="sc">{</span>columna<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(columna)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Frecuencia&#39;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/3ecadce90d817ec07600c38369dd64b763103f35.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/2a203bfd48f46a041fb56ce6bbd00f5ad836b6e0.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/191a108927fd1f6aeb13556af2ec2636fa8affcc.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/5bbf1d531ee62874cb7e8b22bfa99a46b6c0c451.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/0eba7118e950bcc86bde3c164f8d69454a8b7978.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/7f86ceb3275e426956f9d5ab315de7aaf22e13eb.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/eff4f6d932ccc4dd9df4764ecc396c207064cfde.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/e86f29b6f7066ec5ab81649deac6f17794b96bc3.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/8a3bfddb0b238d418a2e56f5977e7a332e4ddb21.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/444c57e43b75fa5ada86e1919bd3747a7fecfb55.png" /></p>
</div>
</div>
<div id="8ec3400e0b7310b" class="cell code" data-execution_count="640"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.752557Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.749236Z&quot;}">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dataset[<span class="st">&quot;bathrooms&quot;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="640">
<pre><code>0       1.0
1       2.5
2       1.0
3       1.5
4       1.0
       ... 
1723    2.5
1724    2.5
1725    1.0
1726    1.0
1727    1.0
Name: bathrooms, Length: 1728, dtype: float64</code></pre>
</div>
</div>
<div id="24e6f1cc23ba7224" class="cell code" data-execution_count="641"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.808263Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.803114Z&quot;}">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convertimos a string las variables cuantitativas que pasamos a cualitativas</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dataset.fireplaces <span class="op">=</span> dataset.fireplaces.astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>dataset.bedrooms <span class="op">=</span> dataset.bedrooms.astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>dataset.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1728 entries, 0 to 1727
Data columns (total 16 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   price            1728 non-null   int64  
 1   lotSize          1728 non-null   float64
 2   age              1728 non-null   int64  
 3   landValue        1728 non-null   int64  
 4   livingArea       1728 non-null   int64  
 5   pctCollege       1728 non-null   int64  
 6   bedrooms         1728 non-null   object 
 7   fireplaces       1728 non-null   object 
 8   bathrooms        1728 non-null   float64
 9   rooms            1728 non-null   int64  
 10  heating          1728 non-null   object 
 11  fuel             1728 non-null   object 
 12  sewer            1728 non-null   object 
 13  waterfront       1728 non-null   object 
 14  newConstruction  1728 non-null   object 
 15  centralAir       1728 non-null   object 
dtypes: float64(2), int64(6), object(8)
memory usage: 216.1+ KB
</code></pre>
</div>
</div>
<div id="94af379bf171af6f" class="cell code" data-execution_count="642"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.844549Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.834392Z&quot;}">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>]).describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="642">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>lotSize</th>
      <th>age</th>
      <th>landValue</th>
      <th>livingArea</th>
      <th>pctCollege</th>
      <th>bathrooms</th>
      <th>rooms</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1728.000000</td>
      <td>1728.000000</td>
      <td>1728.000000</td>
      <td>1728.000000</td>
      <td>1728.000000</td>
      <td>1728.000000</td>
      <td>1728.000000</td>
      <td>1728.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>211966.705440</td>
      <td>0.500214</td>
      <td>27.916088</td>
      <td>34557.187500</td>
      <td>1754.975694</td>
      <td>55.567708</td>
      <td>1.900174</td>
      <td>7.041667</td>
    </tr>
    <tr>
      <th>std</th>
      <td>98441.391015</td>
      <td>0.698680</td>
      <td>29.209988</td>
      <td>35021.168056</td>
      <td>619.935553</td>
      <td>10.333581</td>
      <td>0.658352</td>
      <td>2.316453</td>
    </tr>
    <tr>
      <th>min</th>
      <td>5000.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>200.000000</td>
      <td>616.000000</td>
      <td>20.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>145000.000000</td>
      <td>0.170000</td>
      <td>13.000000</td>
      <td>15100.000000</td>
      <td>1300.000000</td>
      <td>52.000000</td>
      <td>1.500000</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>189900.000000</td>
      <td>0.370000</td>
      <td>19.000000</td>
      <td>25000.000000</td>
      <td>1634.500000</td>
      <td>57.000000</td>
      <td>2.000000</td>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>259000.000000</td>
      <td>0.540000</td>
      <td>34.000000</td>
      <td>40200.000000</td>
      <td>2137.750000</td>
      <td>64.000000</td>
      <td>2.500000</td>
      <td>8.250000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>775000.000000</td>
      <td>12.200000</td>
      <td>225.000000</td>
      <td>412600.000000</td>
      <td>5228.000000</td>
      <td>82.000000</td>
      <td>4.500000</td>
      <td>12.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="925a450a38d1f1cf" class="cell markdown">
<p><font size="4"></p>
<p>Procedemos analizar la correlación de todas las variables entre si,
para ello, seguiremos el esquema de esta tabla:</p>
<table>
<colgroup>
<col style="width: 36%" />
<col style="width: 36%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="header">
<th>Tipo de correlación</th>
<th>Impacto en regresión lineal</th>
<th>Solución recomendada</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alta correlación entre predictores (multicolinealidad)</td>
<td>Coeficientes inestables, dificultad de interpretación</td>
<td>Eliminar variables, regularización, PCA</td>
</tr>
<tr class="even">
<td>Baja o nula correlación con variable objetivo</td>
<td>Variable poco útil, agrega ruido</td>
<td>Eliminar variable o revisar su relevancia</td>
</tr>
<tr class="odd">
<td>Correlación moderada a alta con variable objetivo</td>
<td>Útil para predecir</td>
<td>Mantener en el modelo</td>
</tr>
</tbody>
</table>
<p>En el código de a continuación, se genera la matriz de correlación
utilizando un mapa de calor. En él, podemos ver como de relacionadas
están las variables entre sí. Valores cercanos a 1 y a -1 significa que
esas dos variables están muy relacionadas entre sí, en cambio, valores
cercanos a 0, significa que las variables no están relacionadas entre
sí, lo cual puede ser positivo o no, dependiendo de si las dos variables
son predictoras o, una predictora y la otra objetivo.</p>
</div>
<div id="b5605c314c44110b" class="cell code" data-execution_count="643"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.969193Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.866148Z&quot;}">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># calculamos la matriz de correlación</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>dataset_num <span class="op">=</span> dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int64&#39;</span>, <span class="st">&#39;float64&#39;</span>])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="op">=</span> dataset_num.corr()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(corr_matrix)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&quot;.2f&quot;</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Matriz de correlación&#39;</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>               price   lotSize       age  landValue  livingArea  pctCollege  \
price       1.000000  0.158333 -0.188793   0.581266    0.712390    0.200119   
lotSize     0.158333  1.000000 -0.016352   0.059222    0.163450   -0.033148   
age        -0.188793 -0.016352  1.000000  -0.021818   -0.174242   -0.037785   
landValue   0.581266  0.059222 -0.021818   1.000000    0.423441    0.228427   
livingArea  0.712390  0.163450 -0.174242   0.423441    1.000000    0.209981   
pctCollege  0.200119 -0.033148 -0.037785   0.228427    0.209981    1.000000   
bathrooms   0.597250  0.084823 -0.361897   0.297498    0.718564    0.179541   
rooms       0.531170  0.137604 -0.082264   0.298865    0.733666    0.157068   

            bathrooms     rooms  
price        0.597250  0.531170  
lotSize      0.084823  0.137604  
age         -0.361897 -0.082264  
landValue    0.297498  0.298865  
livingArea   0.718564  0.733666  
pctCollege   0.179541  0.157068  
bathrooms    1.000000  0.517585  
rooms        0.517585  1.000000  
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/002aaaf5f6903379085c59e27e36964f65604f2d.png" /></p>
</div>
</div>
<div id="a6a5a4fa5d6d721f" class="cell markdown">
<p><font size="4"></p>
<p>Tras analizar la correlación entre las variables. Procedemos a
mantener todas las variables aunque, podríamos eliminar:</p>
<ul>
<li><p>livingArea: por su alta correlación con las variables rooms y
bathrooms.</p></li>
<li><p>lotSize, age y bathrooms: por su baja correlación con respecto a
la variable objetivo. <br> <br> <br></p>
<h4 id="análisis-de-las-variables-cualitativas">Análisis de las
variables cualitativas</h4></li>
</ul>
<p>Para el análisis de las variables cualitativas, vamos a proceder,
primeramente a graficar cada una de ella con la finalidad de observar
como se distribuyen los datos (cuanta cantidad de cada opción hay en
cada variable).</p>
<p>Analizando las gráficas de densidad de las variables cualitativas nos
damos cuenta que hay valores en ciertas variables los cuales están muy
por debajo del resto de esa misma variable, es por ello que vamos a
agruparlos. Las agrupaciones que vamos a realizar son las
siguientes:</p>
<ul>
<li>bedrooms: los valores que tendrá son [1, 2, 3, 4, 5 o más]</li>
<li>fireplaces: los valores que tendrá son [0, 1, 2 o más]</li>
</ul>
</div>
<div id="754a1cd2586f1a7e" class="cell code" data-execution_count="644"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:09.996138Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:09.988125Z&quot;}">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&quot;object&quot;</span>]).describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="644">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bedrooms</th>
      <th>fireplaces</th>
      <th>heating</th>
      <th>fuel</th>
      <th>sewer</th>
      <th>waterfront</th>
      <th>newConstruction</th>
      <th>centralAir</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1728</td>
      <td>1728</td>
      <td>1728</td>
      <td>1728</td>
      <td>1728</td>
      <td>1728</td>
      <td>1728</td>
      <td>1728</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>7</td>
      <td>5</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>3</td>
      <td>1</td>
      <td>hot air</td>
      <td>gas</td>
      <td>public/commercial</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>822</td>
      <td>942</td>
      <td>1121</td>
      <td>1197</td>
      <td>1213</td>
      <td>1713</td>
      <td>1647</td>
      <td>1093</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="4a2d548237062f41" class="cell code" data-execution_count="645"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:10.281257Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:10.022814Z&quot;}">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">5</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flat</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>columnas_object <span class="op">=</span> dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, colum <span class="kw">in</span> <span class="bu">enumerate</span>(columnas_object):</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    dataset[colum].value_counts().plot.barh(ax <span class="op">=</span> axes[i])</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(colum, fontsize <span class="op">=</span> <span class="dv">7</span>, fontweight <span class="op">=</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    axes[i].tick_params(labelsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(<span class="st">&quot;&quot;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Se eliminan los axes vacíos</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="dv">7</span>, <span class="dv">8</span>]:</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    fig.delaxes(axes[i])</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&#39;Distribución variables cualitativas&#39;</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>             fontsize <span class="op">=</span> <span class="dv">10</span>, fontweight <span class="op">=</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># calculamos densidad de valores de cada variable</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> columna <span class="kw">in</span> dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns:</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>dataset[columna]<span class="sc">.</span>value_counts()<span class="sc">.</span>sort_index()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;*&quot;</span><span class="op">*</span><span class="dv">30</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>bedrooms
1      7
2    348
3    822
4    487
5     53
6      8
7      3
Name: count, dtype: int64
******************************
fireplaces
0    740
1    942
2     42
3      2
4      2
Name: count, dtype: int64
******************************
heating
electric            305
hot air            1121
hot water/steam     302
Name: count, dtype: int64
******************************
fuel
electric     315
gas         1197
oil          216
Name: count, dtype: int64
******************************
sewer
none                   12
public/commercial    1213
septic                503
Name: count, dtype: int64
******************************
waterfront
No     1713
Yes      15
Name: count, dtype: int64
******************************
newConstruction
No     1647
Yes      81
Name: count, dtype: int64
******************************
centralAir
No     1093
Yes     635
Name: count, dtype: int64
******************************
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/7afb08278843a4ad0c793e4357e08978f18f70c1.png" /></p>
</div>
</div>
<div id="eb0b77b230ed120" class="cell markdown">
<p><font size="4"></p>
<p>Procedemos a agrupar los valores que hemos mencionado
anteriormente:</p>
</div>
<div id="f8f32497666cbf76" class="cell code" data-execution_count="646"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:10.303225Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:10.299195Z&quot;}">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># agrupamos valores columna bedrooms</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mapa_bedrooms <span class="op">=</span> {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;1&quot;</span> : <span class="st">&quot;1&quot;</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2&quot;</span> : <span class="st">&quot;2&quot;</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;3&quot;</span> : <span class="st">&quot;3&quot;</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;4&quot;</span> : <span class="st">&quot;4&quot;</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;5&quot;</span> : <span class="st">&quot;&gt;5&quot;</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;6&quot;</span> : <span class="st">&quot;&gt;5&quot;</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;7&quot;</span> : <span class="st">&quot;&gt;5&quot;</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>dataset[<span class="st">&#39;bedrooms&#39;</span>] <span class="op">=</span> dataset[<span class="st">&#39;bedrooms&#39;</span>].<span class="bu">map</span>(mapa_bedrooms)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>dataset[<span class="st">&#39;bedrooms&#39;</span>].unique().tolist()</span></code></pre></div>
<div class="output execute_result" data-execution_count="646">
<pre><code>[&#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;&gt;5&#39;, &#39;1&#39;]</code></pre>
</div>
</div>
<div id="7b053d9514ffe247" class="cell code" data-execution_count="647"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:10.316292Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:10.312884Z&quot;}">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># agrupamos valores columna fireplace</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mapa_fireplaces <span class="op">=</span> {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;0&quot;</span> : <span class="st">&quot;0&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;1&quot;</span> : <span class="st">&quot;1&quot;</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2&quot;</span> : <span class="st">&quot;&gt;2&quot;</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;3&quot;</span> : <span class="st">&quot;&gt;2&quot;</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;4&quot;</span> : <span class="st">&quot;&gt;2&quot;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>dataset[<span class="st">&quot;fireplaces&quot;</span>] <span class="op">=</span> dataset[<span class="st">&quot;fireplaces&quot;</span>].<span class="bu">map</span>(mapa_fireplaces)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>dataset[<span class="st">&quot;fireplaces&quot;</span>].unique().tolist()</span></code></pre></div>
<div class="output execute_result" data-execution_count="647">
<pre><code>[&#39;1&#39;, &#39;0&#39;, &#39;&gt;2&#39;]</code></pre>
</div>
</div>
<div id="754bf0858b17c5c6" class="cell markdown">
<p><font size="4"></p>
<p>Una vez realizado todo el análisis exploratorio de los datos sobre
las variables cuantitativas y cualitativas, vamos a proceder a
representar como están distribuidos los datos de cada una de las
variables cualitativas con respecto a la variable objetivo (precio).</p>
</div>
<div id="3a37e0abf34ddd34" class="cell code" data-execution_count="648"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:10.950947Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:10.353172Z&quot;}">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> ticker</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">5</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flat</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>columnas_object <span class="op">=</span> dataset.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, colum <span class="kw">in</span> <span class="bu">enumerate</span>(columnas_object):</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    sns.violinplot(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        x     <span class="op">=</span> colum,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        y     <span class="op">=</span> <span class="st">&#39;price&#39;</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        data  <span class="op">=</span> dataset,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        ax    <span class="op">=</span> axes[i]</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(<span class="ss">f&quot;precio vs </span><span class="sc">{</span>colum<span class="sc">}</span><span class="ss">&quot;</span>, fontsize <span class="op">=</span> <span class="dv">7</span>, fontweight <span class="op">=</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    axes[i].yaxis.set_major_formatter(ticker.EngFormatter())</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    axes[i].tick_params(labelsize <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(<span class="st">&quot;&quot;</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    axes[i].set_ylabel(<span class="st">&quot;&quot;</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Se eliminan los axes vacíos</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="dv">7</span>, <span class="dv">8</span>]:</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    fig.delaxes(axes[i])</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(top<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&#39;Distribución del precio por grupo&#39;</span>, fontsize <span class="op">=</span> <span class="dv">10</span>, fontweight <span class="op">=</span> <span class="st">&quot;bold&quot;</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_3f53e3f34e8f4052af7dcedaaab39ade/c65db8f5b0b768a8d6e5df29a98fd368b49b4c1c.png" /></p>
</div>
</div>
<div id="e44d63444b3b393b" class="cell markdown">
<p><font size="4"></p>
<h1 id="preprocesamiento-de-los-datos">Preprocesamiento de los
datos</h1>
<p>Hasta este punto, hemos extraído gran cantidad de información del
dataset y, ahora a continuación, vamos a preparar los datos para que el
modelo los coja como está diseñado, es decir, vamos a realizar el
preprocesamiento de los datos.</p>
<p>Primero, dividiremos el dataset en conjunto train y conjunto test.
Después procederemos a realizar el preprocesamiento de las variables.
Para ello, aplicaremos varios métodos:</p>
<ul>
<li>variables cuantitativas: utilizaremos un standar_scaler para que los
valores estén normalizados con media=0 y desviación=1</li>
<li>variables cualitativas: dependiendo del caso, utilizaremos
OneHotEncoding o LabelEncoding</li>
</ul>
<p>Para realizar el preprocesamiento usaremos la funcion
ColumnTransformer para hacer las transformaciones en paralelo</p>
</div>
<div id="78cb6d16ea037af8" class="cell code" data-execution_count="649"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:10.990745Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:10.986749Z&quot;}">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Division del dataset en train y test</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    dataset.drop(<span class="st">&quot;price&quot;</span>, axis<span class="op">=</span><span class="st">&quot;columns&quot;</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    dataset[<span class="st">&quot;price&quot;</span>],</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_train.shape, y_train.shape, x_test.shape, y_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(1209, 15) (1209,) (519, 15) (519,)
</code></pre>
</div>
</div>
<div id="b2ed706aacb13527" class="cell code" data-execution_count="650"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.026584Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.023911Z&quot;}">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>col_cualitativas <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">&quot;object&quot;</span>]).columns.tolist()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>col_cuantitativas <span class="op">=</span> x_train.select_dtypes(include<span class="op">=</span>[<span class="st">&quot;int64&quot;</span>, <span class="st">&quot;float64&quot;</span>]).columns.tolist()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Diseñamos el preprocesador</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>preprocesador <span class="op">=</span> ColumnTransformer(</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                   [(<span class="st">&#39;scale&#39;</span>, StandardScaler(), col_cuantitativas),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                    (<span class="st">&#39;onehot&#39;</span>, OneHotEncoder(drop<span class="op">=</span><span class="st">&quot;first&quot;</span>,handle_unknown<span class="op">=</span><span class="st">&#39;ignore&#39;</span>, sparse_output<span class="op">=</span><span class="va">False</span>), col_cualitativas)],</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                remainder <span class="op">=</span> <span class="st">&#39;passthrough&#39;</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                verbose_feature_names_out <span class="op">=</span> <span class="va">False</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>               ).set_output(transform<span class="op">=</span><span class="st">&quot;pandas&quot;</span>)</span></code></pre></div>
</div>
<div id="a70e5654185f1642" class="cell code" data-execution_count="651"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.066433Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.062559Z&quot;}">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> set_config</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>set_config(display<span class="op">=</span><span class="st">&#39;diagram&#39;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>preprocesador</span></code></pre></div>
<div class="output execute_result" data-execution_count="651">
<style>#sk-container-id-30 {color: black;background-color: white;}#sk-container-id-30 pre{padding: 0;}#sk-container-id-30 div.sk-toggleable {background-color: white;}#sk-container-id-30 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-30 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-30 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-30 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-30 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-30 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-30 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-30 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-30 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-30 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-30 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-30 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-30 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-30 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-30 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-30 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-30 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-30 div.sk-item {position: relative;z-index: 1;}#sk-container-id-30 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-30 div.sk-item::before, #sk-container-id-30 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-30 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-30 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-30 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-30 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-30 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-30 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-30 div.sk-label-container {text-align: center;}#sk-container-id-30 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-30 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-30" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                  transformers=[(&#x27;scale&#x27;, StandardScaler(),
                                 [&#x27;lotSize&#x27;, &#x27;age&#x27;, &#x27;landValue&#x27;, &#x27;livingArea&#x27;,
                                  &#x27;pctCollege&#x27;, &#x27;bathrooms&#x27;, &#x27;rooms&#x27;]),
                                (&#x27;onehot&#x27;,
                                 OneHotEncoder(drop=&#x27;first&#x27;,
                                               handle_unknown=&#x27;ignore&#x27;,
                                               sparse_output=False),
                                 [&#x27;bedrooms&#x27;, &#x27;fireplaces&#x27;, &#x27;heating&#x27;, &#x27;fuel&#x27;,
                                  &#x27;sewer&#x27;, &#x27;waterfront&#x27;, &#x27;newConstruction&#x27;,
                                  &#x27;centralAir&#x27;])],
                  verbose_feature_names_out=False)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-170" type="checkbox" ><label for="sk-estimator-id-170" class="sk-toggleable__label sk-toggleable__label-arrow">ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(remainder=&#x27;passthrough&#x27;,
                  transformers=[(&#x27;scale&#x27;, StandardScaler(),
                                 [&#x27;lotSize&#x27;, &#x27;age&#x27;, &#x27;landValue&#x27;, &#x27;livingArea&#x27;,
                                  &#x27;pctCollege&#x27;, &#x27;bathrooms&#x27;, &#x27;rooms&#x27;]),
                                (&#x27;onehot&#x27;,
                                 OneHotEncoder(drop=&#x27;first&#x27;,
                                               handle_unknown=&#x27;ignore&#x27;,
                                               sparse_output=False),
                                 [&#x27;bedrooms&#x27;, &#x27;fireplaces&#x27;, &#x27;heating&#x27;, &#x27;fuel&#x27;,
                                  &#x27;sewer&#x27;, &#x27;waterfront&#x27;, &#x27;newConstruction&#x27;,
                                  &#x27;centralAir&#x27;])],
                  verbose_feature_names_out=False)</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-171" type="checkbox" ><label for="sk-estimator-id-171" class="sk-toggleable__label sk-toggleable__label-arrow">scale</label><div class="sk-toggleable__content"><pre>[&#x27;lotSize&#x27;, &#x27;age&#x27;, &#x27;landValue&#x27;, &#x27;livingArea&#x27;, &#x27;pctCollege&#x27;, &#x27;bathrooms&#x27;, &#x27;rooms&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-172" type="checkbox" ><label for="sk-estimator-id-172" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-173" type="checkbox" ><label for="sk-estimator-id-173" class="sk-toggleable__label sk-toggleable__label-arrow">onehot</label><div class="sk-toggleable__content"><pre>[&#x27;bedrooms&#x27;, &#x27;fireplaces&#x27;, &#x27;heating&#x27;, &#x27;fuel&#x27;, &#x27;sewer&#x27;, &#x27;waterfront&#x27;, &#x27;newConstruction&#x27;, &#x27;centralAir&#x27;]</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-174" type="checkbox" ><label for="sk-estimator-id-174" class="sk-toggleable__label sk-toggleable__label-arrow">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder(drop=&#x27;first&#x27;, handle_unknown=&#x27;ignore&#x27;, sparse_output=False)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-175" type="checkbox" ><label for="sk-estimator-id-175" class="sk-toggleable__label sk-toggleable__label-arrow">remainder</label><div class="sk-toggleable__content"><pre></pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-176" type="checkbox" ><label for="sk-estimator-id-176" class="sk-toggleable__label sk-toggleable__label-arrow">passthrough</label><div class="sk-toggleable__content"><pre>passthrough</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div id="98ece62f3f3ec62c" class="cell markdown">
<p><font size="4"></p>
<h1 id="creamos-modelo-entrenamos-y-calculamos-métricas">Creamos modelo,
entrenamos y calculamos métricas</h1>
<p>En este bloque vamos a definir un modelo de caja negra al cual le
aplicaremos métodos agnósticos para entender las decisiones del modelo.
Acto seguido utilizaremos los métodos explicativos basados en ejemplos.
En cuanto al algoritmo que vamos a emplear, se trata del K-Vecinos
Cercanos.</p>
<p>Los <strong>métodos de explicación basados en ejemplos</strong> son
técnicas que ayudan a entender las predicciones de un modelo de machine
learning mostrando casos concretos del conjunto de datos que son
similares a la instancia que se quiere explicar. En lugar de analizar el
funcionamiento interno del modelo o la importancia de las variables,
estos métodos ofrecen interpretaciones comparando el caso actual con
otros ejemplos ya vistos, como los más cercanos, los más representativos
(prototipos), los más influyentes o aquellos que hubieran cambiado el
resultado (contrafactuales). Son especialmente útiles porque permiten a
los usuarios, incluso sin conocimientos técnicos, comprender las
decisiones del modelo a través de ejemplos reales y comparables.</p>
<p>El algoritmo <strong>k-Nearest Neighbors (k-NN)</strong> es un método
de aprendizaje supervisado que se utiliza tanto para clasificación como
para regresión. Funciona buscando los <strong>k ejemplos más
cercanos</strong> (según una medida de distancia, como la euclidiana) al
nuevo punto que se quiere predecir. En clasificación, la predicción se
hace eligiendo la clase más común entre esos vecinos; en regresión, se
calcula el promedio de sus valores numéricos. K-NN no entrena un modelo
explícito, sino que <strong>almacena todos los datos</strong> y realiza
el cálculo en el momento de la predicción, por lo que se considera un
método <strong>basado en instancias</strong> y de tipo
<strong>perezoso</strong>.</p>
</div>
<div id="b2b7464838e46e4d" class="cell code" data-execution_count="652"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.103655Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.101567Z&quot;}">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vemos tamaño del dataset de train y test</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>x_train.shape, x_test.shape, y_train.shape, y_test.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="652">
<pre><code>((1209, 15), (519, 15), (1209,), (519,))</code></pre>
</div>
</div>
<div id="10053c7b64eeb5ee" class="cell markdown">
<p><font size="4"></p>
<p>La explicación basada en KNN (k-Nearest Neighbors) consiste en
justificar la predicción de un modelo mostrando las instancias del
conjunto de entrenamiento que son más similares a la observación que se
quiere explicar. En lugar de analizar cómo funciona internamente el
modelo, este enfoque se basa en comparar la entrada actual con sus
<strong>k vecinos más cercanos</strong> según una medida de distancia
(como la euclidiana). Para la regresión, la predicción es el promedio de
los valores objetivo de esos vecinos, por lo que se puede interpretar
diciendo: <em>“Este valor se predijo porque es similar a estos otros
casos, que tenían valores así”</em>. Esto facilita la comprensión para
usuarios no expertos, ya que ofrece ejemplos concretos que ilustran cómo
el modelo llega a sus decisiones.</p>
</div>
<div id="5fcfa8662deb37cd" class="cell code" data-execution_count="653"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.647599Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.136489Z&quot;}">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos el modelo</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>modelo_KNN <span class="op">=</span> KNeighborsRegressor()</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># definimos hiperparámetros con el nombre correcto del paso</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>hiperparametros <span class="op">=</span> {</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;model__n_neighbors&#39;</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>],</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;model__weights&#39;</span>: [<span class="st">&#39;uniform&#39;</span>, <span class="st">&#39;distance&#39;</span>],</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;model__p&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># definimos el pipeline</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline(steps<span class="op">=</span>[</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;preprocessor&#39;</span>, preprocesador),</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&#39;model&#39;</span>, modelo_KNN),</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># definimos gridsearchCV con el pipeline entero</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    estimator<span class="op">=</span>pipeline,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    param_grid<span class="op">=</span>hiperparametros,</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">&#39;neg_mean_squared_error&#39;</span>,</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co"># entrenamos el modelo</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>grid_search.fit(x_train, y_train)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co"># mejores parametros</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Mejores parametros: </span><span class="sc">{</span>grid_search<span class="sc">.</span>best_params_<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Mejor score (neg MSE): </span><span class="sc">{</span>grid_search<span class="sc">.</span>best_score_<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="co"># predecimos el modelo</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> grid_search.best_estimator_.predict(x_test)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="co"># guardamos el mejor modelo</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>mejor_modelo <span class="op">=</span> grid_search.best_estimator_</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mejores parametros: {&#39;model__n_neighbors&#39;: 11, &#39;model__p&#39;: 1, &#39;model__weights&#39;: &#39;distance&#39;}
Mejor score (neg MSE): -3342591564.293102
</code></pre>
</div>
</div>
<div id="578ea059b227d9a8" class="cell markdown">
<p><font size="4"></p>
<p>Podemos observar que la mejor combinación dada por el gridsearchCV
es:</p>
<ul>
<li>número de vecinos = 11</li>
<li>los vecinos más cercanos son los que tendrán un peso mayor</li>
<li>la métrica que se usa para medir la distntacia será la distancia
manhattan</li>
</ul>
</div>
<div id="7e00803ae13dc8f3" class="cell code" data-execution_count="654"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.688448Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.685707Z&quot;}">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluar con métricas</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, mean_absolute_error, r2_score</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>mae <span class="op">=</span> mean_absolute_error(y_test, y_pred)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>r2 <span class="op">=</span> r2_score(y_test, y_pred)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>rmse <span class="op">=</span> np.sqrt(mse)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;R²     : </span><span class="sc">{</span>r2<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;MAE    : </span><span class="sc">{</span>mae<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;RMSE   : </span><span class="sc">{</span>rmse<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>R²     : 0.5985
MAE    : 42752.76
RMSE   : 67373.71
</code></pre>
</div>
</div>
<div id="74982acebbceed82" class="cell markdown">
<p><font size="4"></p>
<p>Procedemos a utilizar el método explicativo de KNN para explicar dos
instancias de set de test, para que no hayan sido entrenadas
anteriormente por el modelo.</p>
</div>
<div id="cc5c88a11acfac3c" class="cell code" data-execution_count="655"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.727829Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.723342Z&quot;}">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seleccionamos un par de ejemplos para su explicabilidad</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>instancia1 <span class="op">=</span> x_test.iloc[[<span class="dv">1</span>]]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>index_1 <span class="op">=</span> instancia1.index[<span class="dv">0</span>]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>instancia2 <span class="op">=</span> x_test.iloc[[<span class="dv">10</span>]]</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>index_2 <span class="op">=</span> instancia2.index[<span class="dv">0</span>]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>instancia1</span></code></pre></div>
<div class="output execute_result" data-execution_count="655">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lotSize</th>
      <th>age</th>
      <th>landValue</th>
      <th>livingArea</th>
      <th>pctCollege</th>
      <th>bedrooms</th>
      <th>fireplaces</th>
      <th>bathrooms</th>
      <th>rooms</th>
      <th>heating</th>
      <th>fuel</th>
      <th>sewer</th>
      <th>waterfront</th>
      <th>newConstruction</th>
      <th>centralAir</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1201</th>
      <td>0.48</td>
      <td>31</td>
      <td>72600</td>
      <td>3968</td>
      <td>62</td>
      <td>&gt;5</td>
      <td>&gt;2</td>
      <td>3.5</td>
      <td>12</td>
      <td>hot air</td>
      <td>gas</td>
      <td>public/commercial</td>
      <td>No</td>
      <td>No</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="7ccf1578cafa485e" class="cell code" data-execution_count="656"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.785633Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.778612Z&quot;}">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos la prediccion que nos daría el modelo</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>pred_instancia_1 <span class="op">=</span> mejor_modelo.predict(instancia1)[<span class="dv">0</span>]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>pred_instancia_2 <span class="op">=</span> mejor_modelo.predict(instancia2)[<span class="dv">0</span>]</span></code></pre></div>
</div>
<div id="e23ddd6d0ec4ba6f" class="cell code" data-execution_count="657"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.806332Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.804233Z&quot;}">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;=== Instancia 1 ===&quot;</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Valor calculado: </span><span class="sc">{</span>pred_instancia_1<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;=== Instancia 2 ===&quot;</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Valor calculado: </span><span class="sc">{</span>pred_instancia_2<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>=== Instancia 1 ===
Valor calculado: 427982.94
=== Instancia 2 ===
Valor calculado: 120330.31
</code></pre>
</div>
</div>
<div id="4d455389546022f4" class="cell markdown">
<p><font size="4"></p>
<p>Para explicar la predicción de un modelo KNN de regresión sobre una
instancia específica, primero seleccionamos esa instancia del conjunto
de test y obtenemos su predicción con el modelo completo (que incluye
preprocesamiento). Luego, transformamos tanto el conjunto de
entrenamiento como la instancia con el mismo preprocesador que usa el
modelo para asegurar que estén en el mismo espacio. A continuación,
utilizamos un algoritmo de vecinos más cercanos
(<code>NearestNeighbors</code>) para encontrar los k vecinos más
próximos a la instancia en el conjunto transformado, y mostramos sus
valores reales y distancias. Así, explicamos la predicción basada en
ejemplos reales similares que influyen en el resultado del modelo.</p>
</div>
<div id="28d456854945099c" class="cell code" data-execution_count="658"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.848544Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.835823Z&quot;}">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtenemos el preprocesador ya entrenado</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>preprocesador_KNN <span class="op">=</span> mejor_modelo.named_steps[<span class="st">&#39;preprocessor&#39;</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># aplicamos preprocesamiento al conjunto de train y a nuestras instancias</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>x_train_KNN_preprocesado <span class="op">=</span> preprocesador_KNN.transform(x_train)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>instancia1_preprocesada <span class="op">=</span> preprocesador_KNN.transform(instancia1)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>instancia2_preprocesada <span class="op">=</span> preprocesador_KNN.transform(instancia2)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>instancia1_preprocesada</span></code></pre></div>
<div class="output execute_result" data-execution_count="658">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lotSize</th>
      <th>age</th>
      <th>landValue</th>
      <th>livingArea</th>
      <th>pctCollege</th>
      <th>bathrooms</th>
      <th>rooms</th>
      <th>bedrooms_2</th>
      <th>bedrooms_3</th>
      <th>bedrooms_4</th>
      <th>...</th>
      <th>fireplaces_&gt;2</th>
      <th>heating_hot air</th>
      <th>heating_hot water/steam</th>
      <th>fuel_gas</th>
      <th>fuel_oil</th>
      <th>sewer_public/commercial</th>
      <th>sewer_septic</th>
      <th>waterfront_Yes</th>
      <th>newConstruction_Yes</th>
      <th>centralAir_Yes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1201</th>
      <td>-0.054096</td>
      <td>0.087684</td>
      <td>1.167276</td>
      <td>3.541578</td>
      <td>0.617809</td>
      <td>2.398021</td>
      <td>2.132192</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 22 columns</p>
</div>
</div>
</div>
<div id="8561cc83fd012bcc" class="cell code" data-execution_count="659"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.908609Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.905468Z&quot;}">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cogemos el numero de vecinos mas cercano del modelo</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n_vecinos <span class="op">=</span> mejor_modelo.named_steps[<span class="st">&#39;model&#39;</span>].n_neighbors</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># defimos nuevo modelo con n vecinos obtenidos</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>KNN_vecinos <span class="op">=</span> NearestNeighbors(n_neighbors<span class="op">=</span>n_vecinos)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># entrenamos el modelo</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>KNN_vecinos.fit(x_train_KNN_preprocesado)</span></code></pre></div>
<div class="output execute_result" data-execution_count="659">
<style>#sk-container-id-31 {color: black;background-color: white;}#sk-container-id-31 pre{padding: 0;}#sk-container-id-31 div.sk-toggleable {background-color: white;}#sk-container-id-31 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-31 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-31 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-31 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-31 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-31 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-31 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-31 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-31 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-31 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-31 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-31 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-31 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-31 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-31 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-31 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-31 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-31 div.sk-item {position: relative;z-index: 1;}#sk-container-id-31 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-31 div.sk-item::before, #sk-container-id-31 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-31 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-31 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-31 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-31 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-31 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-31 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-31 div.sk-label-container {text-align: center;}#sk-container-id-31 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-31 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-31" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>NearestNeighbors(n_neighbors=11)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-177" type="checkbox" checked><label for="sk-estimator-id-177" class="sk-toggleable__label sk-toggleable__label-arrow">NearestNeighbors</label><div class="sk-toggleable__content"><pre>NearestNeighbors(n_neighbors=11)</pre></div></div></div></div></div>
</div>
</div>
<div id="5ce59d2e848b82b6" class="cell code" data-execution_count="660"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.936561Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.934448Z&quot;}">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>index_1, index_2</span></code></pre></div>
<div class="output execute_result" data-execution_count="660">
<pre><code>(1201, 1481)</code></pre>
</div>
</div>
<div id="c019479e9601bba9" class="cell code" data-execution_count="661"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:11.963882Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:11.959772Z&quot;}">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para la instancia 1:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># obtenemos distancia e indice de los vecinos mas cercanos</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>distancia, indice <span class="op">=</span> KNN_vecinos.kneighbors(instancia1_preprocesada)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>distancia <span class="op">=</span> distancia[<span class="dv">0</span>].tolist()</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>indice <span class="op">=</span> indice[<span class="dv">0</span>].tolist()</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mostramos resultados</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;==== INSTANCIA 1 ====&quot;</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Valor calculado: </span><span class="sc">{</span>pred_instancia_1<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Valor real: </span><span class="sc">{</span>y_test<span class="sc">.</span>loc[index_1]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Información 11 vecinos más cercanos:&quot;</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,n_vecinos):</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;--&gt; vecino </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">     indice: </span><span class="sc">{</span>indice[i]<span class="sc">}</span><span class="ss">     distancia: </span><span class="sc">{</span>distancia[i]<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>==== INSTANCIA 1 ====
Valor calculado: 427982.94
Valor real: 775000
Información 11 vecinos más cercanos:
--&gt; vecino 1     indice: 688     distancia: 2.214593607361163
--&gt; vecino 2     indice: 341     distancia: 2.357157470671074
--&gt; vecino 3     indice: 420     distancia: 2.3777936198587897
--&gt; vecino 4     indice: 333     distancia: 2.3910810288867825
--&gt; vecino 5     indice: 578     distancia: 2.4688991957930178
--&gt; vecino 6     indice: 735     distancia: 2.643174706978099
--&gt; vecino 7     indice: 1198     distancia: 2.7100917898358263
--&gt; vecino 8     indice: 760     distancia: 2.7267688920062434
--&gt; vecino 9     indice: 747     distancia: 2.7419851817995067
--&gt; vecino 10     indice: 464     distancia: 2.821546873740159
--&gt; vecino 11     indice: 438     distancia: 2.8257974458775856
</code></pre>
</div>
</div>
<div id="dff2cb4c4673a088" class="cell code" data-execution_count="662"
data-ExecuteTime="{&quot;end_time&quot;:&quot;2025-06-26T11:24:12.054468Z&quot;,&quot;start_time&quot;:&quot;2025-06-26T11:24:12.049073Z&quot;}">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para la instancia 1:</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># obtenemos distancia e indice de los vecinos mas cercanos</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>distancia, indice <span class="op">=</span> KNN_vecinos.kneighbors(instancia2_preprocesada)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>distancia <span class="op">=</span> distancia[<span class="dv">0</span>].tolist()</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>indice <span class="op">=</span> indice[<span class="dv">0</span>].tolist()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mostramos resultados</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;==== INSTANCIA 2 ====&quot;</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Valor calculado: </span><span class="sc">{</span>pred_instancia_2<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Valor real: </span><span class="sc">{</span>y_test<span class="sc">.</span>loc[index_2]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Información 11 vecinos más cercanos:&quot;</span>)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,n_vecinos):</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;--&gt; vecino </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">     indice: </span><span class="sc">{</span>indice[i]<span class="sc">}</span><span class="ss">     distancia: </span><span class="sc">{</span>distancia[i]<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>==== INSTANCIA 2 ====
Valor calculado: 120330.31
Valor real: 161000
Información 11 vecinos más cercanos:
--&gt; vecino 1     indice: 838     distancia: 0.47105921071768464
--&gt; vecino 2     indice: 1173     distancia: 0.9640650952419332
--&gt; vecino 3     indice: 1058     distancia: 1.0490332169108256
--&gt; vecino 4     indice: 685     distancia: 1.053888515211604
--&gt; vecino 5     indice: 1149     distancia: 1.0726683689973946
--&gt; vecino 6     indice: 371     distancia: 1.079761819512615
--&gt; vecino 7     indice: 904     distancia: 1.1072879600013323
--&gt; vecino 8     indice: 1030     distancia: 1.3927153331603237
--&gt; vecino 9     indice: 550     distancia: 1.5500018006727365
--&gt; vecino 10     indice: 416     distancia: 1.5860403954643087
--&gt; vecino 11     indice: 805     distancia: 1.67589544557551
</code></pre>
</div>
</div>
<div id="625703b561b0ed3e" class="cell markdown">
<p><font size="4"></p>
<p>El modelo KNN entrenado con los mejores parámetros (n_neighbors=11,
distancia Manhattan y pesos por distancia) muestra un rendimiento
razonable para el problema de regresión. Con un R² cercano a 0.6, el
modelo explica aproximadamente el 60% de la variabilidad en los precios,
lo que indica que capta buena parte de la tendencia general, aunque
todavía queda margen para mejorar. Las métricas de error, como un MAE de
alrededor de 42,753 y un RMSE de 67,374, sugieren que, en promedio, las
predicciones se desvían bastante del valor real, especialmente en
algunos casos puntuales.</p>
<p>Al analizar la explicación basada en ejemplos para dos instancias del
conjunto de prueba, se observa que la calidad de la predicción depende
fuertemente de la proximidad de los vecinos en el espacio de
características. En la primera instancia, el valor predicho es
considerablemente menor que el valor real, y las distancias a los
vecinos más cercanos son relativamente grandes. Esto indica que esta
instancia está en una zona del espacio donde los vecinos no son muy
similares, dificultando una buena predicción. Por el contrario, en la
segunda instancia, las distancias a los vecinos son menores y la
predicción es más cercana al valor real, lo que confirma que el modelo
funciona mejor en regiones con mayor densidad y similitud local de
datos.</p>
<p>Estas observaciones apuntan a que, aunque el KNN con los parámetros
elegidos es adecuado, podría beneficiarse de un mejor preprocesamiento o
de ingeniería de características que reflejen con mayor precisión la
similitud entre instancias. Además, explorar otros modelos o ajustar el
número de vecinos y el tipo de distancia podría ayudar a mejorar el
rendimiento. Finalmente, la explicación basada en vecinos más cercanos
es una herramienta valiosa para entender las predicciones del modelo, ya
que permite ver ejemplos concretos que fundamentan cada estimación y
facilita identificar cuándo y por qué el modelo puede fallar.</p>
</div>
</body>
</html>
